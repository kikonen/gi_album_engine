<div class="gi-full-height"
     id="tableContainer"
     ng-click="index.setPhoto(null)"
     ng-keydown="index.onKeydown($event)"
     ng-swipe-left="index.onSwipeLeft()"
     ng-swipe-right="index.onSwipeRight()"
     tabindex="0">
  <table
      ng-click="index.setPhoto(null)"
      st-table="displayedElements"
      st-safe-src="index.elements"
      class="table gi-album-table">
    <thead>
      <tr>
	<td colspan="2" class="text-center">
          <div gi-thumb=""
               st-items-by-page="index.rows">
          </div>
	  <div st-pagination=""
               st-items-by-page="index.rows"
               st-displayed-pages="5"
               st-template="gi_album/album/pagination"
               >
          </div>
	</td>
      </tr>
    </thead>

    <tr>
      <td colspan="2">
        <div class="gi-thumb gi-thumb-film gi-thumb-dir"
             ng-if="index.dir.length > 1"
             ng-click="index.goUp(index.dir)">
          <%= image_tag 'gi_album/material/keyboard-backspace.svg', class: 'gi-thumb-image' %>
        </div>

        <div class="gi-thumb gi-thumb-film"
             ng-style="{transform: 'rotate(' + index.getRandomRotate(elem) + 'deg)'}"
             ng-class="{'gi-thumb-photo':elem.photo || elem.video, 'gi-thumb-dir':elem.dir}"
             ng-repeat="elem in displayedElements track by elem.name">

          <div class="gi-thumb-content"
               ng-if="elem.dir"
               ng-click="index.goDir(elem.path)">
            <%= image_tag 'gi_album/material/folder-photo.svg', class: 'gi-thumb-image' %>

            <div class="gi-thumb-info">
              <div class="gi-thumb-text">{{ elem.display_name }}</div>
            </div>
          </div>

          <div ng-if="elem.photo"
               ng-click="index.setPhoto(elem, $event)">
            <img class="gi-thumb-image" ng-src="thumb/<%= GiAlbum::Photo::DEF_THUMB_SIZE %>/{{elem.path}}"/>
<!--
            <div class="gi-thumb-info">
              <div>{{ elem.display_name }}</div>
              <div>{{ elem.image_info.format }}</div>
              <div>{{ elem.image_info.size }}</div>
            </div>
-->
          </div>

          <div ng-if="elem.video">
            <a ng-href="http://kari.dy.fi/album/{{elem.path}}" target="_blank">
              <%= image_tag 'gi_album/material/movie.svg', class: 'gi-thumb-image' %>
            </a>
<!--
            <div class="gi-thumb-info">
              <div>{{ elem.display_name }}</div>
            </div>
-->
          </div>
        </div>
      </td>
    </tr>
  </table>
</div>

<div
    class="gi-photo-preview"
    ng-if="index.photo"
    ng-click="index.setPhoto(null, $event)"
    ng-swipe-left="index.nextPhoto(1)"
    ng-swipe-right="index.nextPhoto(-1)"
    ondragstart="return false;"
    >
  <div class="gi-photo-preview-img"
       preview-img="thumb/400/{{index.photo.path}}">
  </div>
  <a ng-href="http://kari.dy.fi/album/{{index.photo.path}}" target="_blank">
    <span class="label label-primary">
      {{1 + index.photoIndex - index.firstPhotoIndex}}
      /
      {{index.elements.length - index.firstPhotoIndex}}
    </span>
    &nbsp;
    Open Original
  </a>
</div>
